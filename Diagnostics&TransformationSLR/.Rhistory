bonds <- read.table("bonds.txt", header = TRUE)
setwd("C:/2017/Work/Github/Regression/Regression-Analysis-in-R/Diagnostics&TransformationSLR")
bonds <- read.table("bonds.txt", header = TRUE)
attach(bonds)
head(bonds)
m1 <- lm(BidPrice ~ CouponRate)
summary(m1)
plot(CouponRate, BidPrice, xlab = "Coupon Rate (%)", ylab = "Bid Price ($)", ylim = c(85,
120), xlim = c(2, 14))
abline(lsfit(CouponRate, BidPrice))
abline(lsfit(CouponRate, BidPrice), col('r'))
plot(CouponRate, BidPrice, xlab = "Coupon Rate (%)", ylab = "Bid Price ($)", ylim = c(85,
120), xlim = c(2, 14))
abline(lsfit(CouponRate, BidPrice), col('r'))
abline(lsfit(CouponRate, BidPrice), col = 'r')
abline(lsfit(CouponRate, BidPrice), col = 'red')
plot(CouponRate, BidPrice, xlab = "Coupon Rate (%)", ylab = "Bid Price ($)", ylim = c(85,
120), xlim = c(2, 14))
leverage1 <- hatvalues(m1)
StanRes1 <- rstandard(m1)
residual1 <- m1$residuals
par(mfrow = c(1, 2))
plot(CouponRate, residual1)
plot(CouponRate, StanRes1)
abline(h=2, col = 'red')
plot(CouponRate, residual1, title = 'Residuals')
plot(CouponRate, StanRes1, title = 'Standard Residuals')
abline(h=2, col = 'red')
plot(CouponRate, residual1, main = 'Residuals')
plot(CouponRate, StanRes1, main =  'Standard Residuals')
abline(h=2, col = 'red')
Case[which(abs(StanRes1) > 2)] # Identify outliers
Case[which(leverage1 > 4/nrow(bonds))] # leverage points
m2 <- update(m1, subset = (1:35)[-c(4, 13, 35)])
summary(m2)
plot(CouponRate[-c(4, 13, 35)], BidPrice[-c(4, 13, 35)], xlab = "Coupon Rate (%)",
ylab = "Bid Price ($)", ylim = c(85, 120), xlim = c(2, 14), main = "Regular Bonds")
par(mfrow = c(1,1))
plot(CouponRate[-c(4, 13, 35)], BidPrice[-c(4, 13, 35)], xlab = "Coupon Rate (%)",
ylab = "Bid Price ($)", ylim = c(85, 120), xlim = c(2, 14), main = "Regular Bonds")
abline(m2, col= 'red')
StanRes2 <- rstandard(m2)
plot(CouponRate[-c(4, 13, 35)], StanRes2, xlab = "Coupon Rate (%)", ylab = "Standardized Residuals", xlim = c(2, 14), main = "Regular Bonds")
abline(h = 2, lty = 2)
abline(h = -2, lty = 2)
abline(h = 2, lty = 2, col = 'red')
abline(h = -2, lty = 2, col = 'red')
Team TeamBattingAverage TeamWinningPercentage
## 1 Baltimore 0.266 0.574
## 2 Boston 0.269 0.661
## 3 California 0.256 0.508
## 4 Chicago 0.246 0.410
## 5 Cleveland 0.271 0.500
## 6 Detroit 0.259 0.467
## 7 Kansas City 0.250 0.508
## 8 Milwaukee 0.271 0.525
## 9 Minnesota 0.274 0.403
## 10 New York 0.268 0.587
## 11 Oakland 0.252 0.422
## 12 Seattle 0.246 0.391
## 13 Texas 0.263 0.548
## 14 Toronto 0.270 0.500
cd1 <- cooks.distance(m1)
plot(CouponRate, cd1, ylab = "Cook's Distance")
abline(h = 4/(35 - 2), lty = 2)
abline(h = 4/(35 - 2), lty = 2, col = 'red')
cd1 <- cooks.distance(m1)
plot(CouponRate, cd1, ylab = "Cook's Distance", main = 'Inluential Points on Cook\'s D')
abline(h = 4/(35 - 2), lty = 2, col = 'red')
cd1 <- cooks.distance(m1)
plot(CouponRate, cd1, ylab = "Cook's Distance", main = 'Inluential Points on Cook\'s D')
text(CouponRate, cd1, labels = Case, cex = 0.6, pos = 3)
abline(h = 4/(35 - 2), lty = 2, col = 'red')
setwd("C:/2017/Work/Github/Regression/Regression-Analysis-in-R/Diagnostics&TransformationSLR")
cleaning <- read.table("cleaning.txt", header = TRUE)
head(cleaning, 10)
attach(cleaning)
plot(Crews, Rooms, xlab = "Number of Crews", ylab = "Number of Rooms Cleaned")
abline(lsfit(Crews, Rooms), col = "blue")
m1 <- lm(Rooms ~ Crews)
summary(m1)
predict(m1, newdata = data.frame(Crews = c(4, 16)), interval = "prediction", level = 0.95)
StanRes1 <- rstandard(m1)
plot(Crews, StanRes1, xlab = "Number of Crews", ylab = "Standardized Residuals")
plot(Crews, StanRes1, xlab = "Number of Crews", ylab = "Standardized Residuals", main="standard Residuals", col.main="red", cex.lab = 1)
plot(Crews, StanRes1, xlab = "Number of Crews", ylab = "Standardized Residuals", main="Standard Residuals", col.main="red", cex.lab = 1)
plot(Crews, StanRes1, xlab = "Number of Crews", ylab = "Standardized Residuals", main="Standard Residuals", col.main="green", cex.lab = 2)
plot(Crews, StanRes1, xlab = "Number of Crews", ylab = "Standardized Residuals", main="Standard Residuals", col.main="green", cex.lab = 1.2)
plot(Crews, StanRes1, xlab = "Number of Crews", ylab = "Standardized Residuals", main="Standard Residuals", col.main="blue", cex.lab = 1.2)
par(mfrow = c(2, 2))
plot(m1)
sqrtcrews <- sqrt(Crews)
sqrtrooms <- sqrt(Rooms)
m2 <- lm(sqrtrooms ~ sqrtcrews)
summary(m2)
par(mfrow = c(1, 2))
plot(sqrt(Crews), sqrt(Rooms), xlab = "Square Root(Number of Crews)", ylab = "Square Root(Number of Rooms)")
abline(lsfit(sqrt(Crews), sqrt(Rooms)))
par(mfrow = c(1, 2))
plot(sqrt(Crews), sqrt(Rooms), xlab = "Square Root(Number of Crews)", ylab = "Square Root(Number of Rooms)")
abline(lsfit(sqrt(Crews), sqrt(Rooms)), col = "blue")
plot(sqrt(Crews), sqrt(Rooms), xlab = "Square Root(Number of Crews)", ylab = "Square Root(Number of Rooms)", cex.lab = 1.2)
par(mfrow = c(1, 2))
plot(sqrt(Crews), sqrt(Rooms), xlab = "Square Root(Number of Crews)", ylab = "Square Root(Number of Rooms)", cex.lab = 1.2)
par(mfrow = c(1, 2))
plot(sqrt(Crews), sqrt(Rooms), xlab = "Square Root(Number of Crews)", ylab = "Square Root(Number of Rooms)", cex.lab = 1.1)
abline(lsfit(sqrt(Crews), sqrt(Rooms)), col = "blue")
StanRes2 <- rstandard(m2)
plot(sqrtcrews, StanRes2, xlab = "Square Root(Number of Crews)", ylab = "Standardized Residuals")
par(mfrow = c(1, 2))
plot(sqrt(Crews), sqrt(Rooms), xlab = "Square Root(Number of Crews)", ylab = "Square Root(Number of Rooms)", cex.lab = 1.1, main = "Square Root Trans.")
abline(lsfit(sqrt(Crews), sqrt(Rooms)), col = "blue")
StanRes2 <- rstandard(m2)
plot(sqrtcrews, StanRes2, xlab = "Square Root(Number of Crews)", ylab = "Standardized Residuals", cex.lab = 1.1, main = "Std. Residuals plot")
confood1 <- read.table("confood1.txt", header = TRUE)
attach(confood1)
head(confood1)
plot(Price, Sales)
par(mforw =(1,1))
par(mforw =c(1,1))
par(mfrow =c(1,1))
plot(Price, Sales)
plot(Price, Sales, cex.lab =1.1, main = "scatter plot of Price Vs. Sales")
plot(Price, Sales, cex.lab =1.1, main = "Scatter plot of Price Vs. Sales", col.main = "blue")
abline(lsfit(Price, Sales), col = "Hue")
abline(lsfit(Price, Sales), col = "blue")
plot(log(Price), log(Sales), xlab = "log(Price)", ylab = "log(Sales)", "Scatter plot of Log(Price) Vs. Log(Sales)", col.main = "blue")
plot(log(Price), log(Sales), xlab = "log(Price)", ylab = "log(Sales)", "Scatter plot of Log(Price) Vs. Log(Sales)", col.main = "blue")
plot(log(Price), log(Sales), xlab = "log(Price)", ylab = "log(Sales)", main = "Scatter plot of Log(Price) Vs. Log(Sales)", col.main = "blue")
abline(lsfit(log(Price), log(Sales)), col = "blue")
m1 <- lm(log(Sales) ~ log(Price))
summary(m1)
StanRes1 <- rstandard(m1)
plot(log(Price), StanRes1, xlab = "log(Price)", ylab = "Standardized Residuals")
plot(log(Price), StanRes1, xlab = "log(Price)", ylab = "Standardized Residuals", cex.lab = 1.1, main = "Standard residuals for Log Price")
plot(log(Price), StanRes1, xlab = "log(Price)", ylab = "Standardized Residuals", col.main = "blue", cex.lab = 1.1, main = "Standard residuals for Log Price")
