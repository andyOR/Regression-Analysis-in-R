bonds <- read.table("bonds.txt", header = TRUE)
setwd("C:/2017/Work/Github/Regression/Regression-Analysis-in-R/Diagnostics&TransformationSLR")
bonds <- read.table("bonds.txt", header = TRUE)
attach(bonds)
head(bonds)
m1 <- lm(BidPrice ~ CouponRate)
summary(m1)
plot(CouponRate, BidPrice, xlab = "Coupon Rate (%)", ylab = "Bid Price ($)", ylim = c(85,
120), xlim = c(2, 14))
abline(lsfit(CouponRate, BidPrice))
abline(lsfit(CouponRate, BidPrice), col('r'))
plot(CouponRate, BidPrice, xlab = "Coupon Rate (%)", ylab = "Bid Price ($)", ylim = c(85,
120), xlim = c(2, 14))
abline(lsfit(CouponRate, BidPrice), col('r'))
abline(lsfit(CouponRate, BidPrice), col = 'r')
abline(lsfit(CouponRate, BidPrice), col = 'red')
plot(CouponRate, BidPrice, xlab = "Coupon Rate (%)", ylab = "Bid Price ($)", ylim = c(85,
120), xlim = c(2, 14))
leverage1 <- hatvalues(m1)
StanRes1 <- rstandard(m1)
residual1 <- m1$residuals
par(mfrow = c(1, 2))
plot(CouponRate, residual1)
plot(CouponRate, StanRes1)
abline(h=2, col = 'red')
plot(CouponRate, residual1, title = 'Residuals')
plot(CouponRate, StanRes1, title = 'Standard Residuals')
abline(h=2, col = 'red')
plot(CouponRate, residual1, main = 'Residuals')
plot(CouponRate, StanRes1, main =  'Standard Residuals')
abline(h=2, col = 'red')
Case[which(abs(StanRes1) > 2)] # Identify outliers
Case[which(leverage1 > 4/nrow(bonds))] # leverage points
m2 <- update(m1, subset = (1:35)[-c(4, 13, 35)])
summary(m2)
plot(CouponRate[-c(4, 13, 35)], BidPrice[-c(4, 13, 35)], xlab = "Coupon Rate (%)",
ylab = "Bid Price ($)", ylim = c(85, 120), xlim = c(2, 14), main = "Regular Bonds")
par(mfrow = c(1,1))
plot(CouponRate[-c(4, 13, 35)], BidPrice[-c(4, 13, 35)], xlab = "Coupon Rate (%)",
ylab = "Bid Price ($)", ylim = c(85, 120), xlim = c(2, 14), main = "Regular Bonds")
abline(m2, col= 'red')
StanRes2 <- rstandard(m2)
plot(CouponRate[-c(4, 13, 35)], StanRes2, xlab = "Coupon Rate (%)", ylab = "Standardized Residuals", xlim = c(2, 14), main = "Regular Bonds")
abline(h = 2, lty = 2)
abline(h = -2, lty = 2)
abline(h = 2, lty = 2, col = 'red')
abline(h = -2, lty = 2, col = 'red')
Team TeamBattingAverage TeamWinningPercentage
## 1 Baltimore 0.266 0.574
## 2 Boston 0.269 0.661
## 3 California 0.256 0.508
## 4 Chicago 0.246 0.410
## 5 Cleveland 0.271 0.500
## 6 Detroit 0.259 0.467
## 7 Kansas City 0.250 0.508
## 8 Milwaukee 0.271 0.525
## 9 Minnesota 0.274 0.403
## 10 New York 0.268 0.587
## 11 Oakland 0.252 0.422
## 12 Seattle 0.246 0.391
## 13 Texas 0.263 0.548
## 14 Toronto 0.270 0.500
cd1 <- cooks.distance(m1)
plot(CouponRate, cd1, ylab = "Cook's Distance")
abline(h = 4/(35 - 2), lty = 2)
abline(h = 4/(35 - 2), lty = 2, col = 'red')
cd1 <- cooks.distance(m1)
plot(CouponRate, cd1, ylab = "Cook's Distance", main = 'Inluential Points on Cook\'s D')
abline(h = 4/(35 - 2), lty = 2, col = 'red')
cd1 <- cooks.distance(m1)
plot(CouponRate, cd1, ylab = "Cook's Distance", main = 'Inluential Points on Cook\'s D')
text(CouponRate, cd1, labels = Case, cex = 0.6, pos = 3)
abline(h = 4/(35 - 2), lty = 2, col = 'red')
